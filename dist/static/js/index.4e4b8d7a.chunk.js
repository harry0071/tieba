webpackJsonp([5],{"3vSQ":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={data:function(){return{blogs:[],total:0,page:1}},created:function(){this.page=this.$route.query.page-0||1,this.getTotal(),this.getBlog(this.page)},mixins:[a("vsZy").a],watch:{"$route.query.page":function(t){t||this.getBlog(1)}},methods:{getTotal:function(){var t=this;new this.AV.Query("Blogs").count().then(function(e){t.total=e})},getBlog:function(t){var e=this;this.page=t;var a=new this.AV.Query("Blogs");a.include("user"),a.descending("createdAt"),a.limit(10),a.skip(10*(t-1)),a.find().then(function(t){e.blogs=[],t.forEach(function(t,a){e.blogs.push({id:t.id,title:t.attributes.title,description:t.attributes.description,createdAt:t.createdAt,updatedAt:t.updatedAt,user:{id:t.attributes.userId,username:t.attributes.user.attributes.username,avatar:t.attributes.user.attributes.avatar}})})})},changePage:function(t){this.getBlog(t),this.$router.push({name:"index",query:{page:t}})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.blogs.length?a("div",{attrs:{id:"index"}},[t._l(t.blogs,function(e){return a("section",{key:e.id},[a("router-link",{staticClass:"user",attrs:{to:{name:"user",params:{userId:e.user.id},query:{page:1}}}},[a("figure",[a("img",{attrs:{src:e.user.avatar,title:e.user.username,alt:"头像",width:"60",height:"60"}}),t._v(" "),a("figcaption",[t._v(t._s(e.user.username))])])]),t._v(" "),a("router-link",{staticClass:"link",attrs:{to:{name:"detail",params:{blogId:e.id}}}},[a("h2",[t._v(t._s(e.title)+"\n        "),a("span",[t._v("该文章发布于 "+t._s(t._f("formatDate")(e.createdAt)))])]),t._v(" "),a("p",[t._v(t._s(e.description||e.title))])])],1)}),t._v(" "),a("el-pagination",{attrs:{"current-page":t.page,background:"",layout:"prev, pager, next",total:t.total},on:{"current-change":t.changePage}})],2):t._e()},staticRenderFns:[]};var s=a("VU/8")(r,i,!1,function(t){a("Mx2S")},"data-v-3940717f",null);e.default=s.exports},Mx2S:function(t,e){}});